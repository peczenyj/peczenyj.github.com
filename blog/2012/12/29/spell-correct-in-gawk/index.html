
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Spell Correct in GNU AWK - Peczenyj's Blog</title>
  <meta name="author" content="Tiago Peczenyj">

  
  <meta name="description" content="A small spell correct written in awk with only 15 lines inspired in Peter Norvig's Spell Correct">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://pacman.blog.br/blog/2012/12/29/spell-correct-in-gawk/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Peczenyj's Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-2150536-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <meta property="og:url" value="http://pacman.blog.br/blog/2012/12/29/spell-correct-in-gawk/">
<meta property="og:type" content="website" />

<meta property="og:title" value="Spell Correct in GNU AWK">
<meta property="og:description" value="A small spell correct written in awk with only 15 lines inspired in Peter Norvig's Spell Correct">
 

  <meta property="twitter:card" value="summary">
<meta property="twitter:url" value="http://pacman.blog.br/blog/2012/12/29/spell-correct-in-gawk/">


<meta property="twitter:title" value="Spell Correct in GNU AWK">
<meta property="twitter:description" value="A small spell correct written in awk with only 15 lines inspired in Peter Norvig's Spell Correct">
 


<meta property="twitter:site" value="@pac_man">

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Peczenyj's Blog</a></h1>
  
    <h2>Just Another /Perl|Ruby|C++|Java|Python|JavaScript|Flash|Bash/ Hacker</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:pacman.blog.br" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/contact">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Spell Correct in GNU AWK</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-29T03:17:00-02:00" pubdate data-updated="true">Dec 29<span>th</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Based on <a href="http://norvig.com/spell-correct.html">Peter Norvig Spell Correct</a></p>

<figure class='code'><figcaption><span>small spell corrector in gawk</span><a href='https://gist.github.com/4404742'>link to gist</a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='awk'><span class='line'><span class="c1"># Usage: gawk -v word=some_word_to_verify -f spelling.awk [ big.txt [ big2.txt ... ]]</span>
</span><span class='line'><span class="c1"># Gawk version with 15 lines -- 04/13/2008</span>
</span><span class='line'><span class="c1"># Author: tiago (dot) peczenyj (at) gmail (dot) com</span>
</span><span class='line'><span class="c1">#         about.me/peczenyj</span>
</span><span class='line'><span class="c1"># Based on : http://norvig.com/spell-correct.html</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">edits</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">max</span><span class="p">,</span><span class="nx">candidates</span><span class="p">,</span><span class="nx">list</span><span class="p">,</span>        <span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">){</span>
</span><span class='line'>       <span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span>  <span class="nx">max</span> <span class="p">;</span><span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="o">++</span><span class="nx">list</span><span class="p">[</span><span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># deletes</span>
</span><span class='line'>       <span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span> <span class="nx">max</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="o">++</span><span class="nx">list</span><span class="p">[</span><span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">3</span><span class="p">)]</span> <span class="c1"># transposes</span>
</span><span class='line'>       <span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span>  <span class="nx">max</span> <span class="p">;</span><span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="k">for</span><span class="p">(</span><span class="nx">j</span> <span class="o">in</span> <span class="nx">alpha</span><span class="p">)</span> <span class="o">++</span><span class="nx">list</span><span class="p">[</span><span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="nx">alpha</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># replaces</span>
</span><span class='line'>       <span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;=</span> <span class="nx">max</span> <span class="p">;</span><span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="k">for</span><span class="p">(</span><span class="nx">j</span> <span class="o">in</span> <span class="nx">alpha</span><span class="p">)</span> <span class="o">++</span><span class="nx">list</span><span class="p">[</span><span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="nx">alpha</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="c1"># inserts</span>
</span><span class='line'>       <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">in</span> <span class="nx">list</span><span class="p">)</span> <span class="k">if</span><span class="p">(</span><span class="nx">i</span> <span class="o">in</span> <span class="nx">NWORDS</span><span class="p">)</span> <span class="nx">candidates</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">NWORDS</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">correct</span><span class="p">(</span><span class="nx">word</span>            <span class="p">,</span><span class="nx">candidates</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">list</span><span class="p">,</span><span class="nx">max</span><span class="p">,</span><span class="nx">temp</span><span class="p">){</span>
</span><span class='line'>       <span class="nx">edits</span><span class="p">(</span><span class="nx">word</span><span class="p">,</span><span class="kr">length</span><span class="p">(</span><span class="nx">word</span><span class="p">),</span><span class="nx">candidates</span><span class="p">,</span><span class="nx">list</span><span class="p">)</span>
</span><span class='line'>       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">asort</span><span class="p">(</span><span class="nx">candidates</span><span class="p">,</span><span class="nx">temp</span><span class="p">))</span> <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">in</span> <span class="nx">list</span><span class="p">)</span> <span class="nx">edits</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="kr">length</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span><span class="nx">candidates</span><span class="p">)</span>
</span><span class='line'>       <span class="k">return</span> <span class="p">(</span><span class="nx">max</span> <span class="o">=</span> <span class="nx">asorti</span><span class="p">(</span><span class="nx">candidates</span><span class="p">))</span> <span class="err">?</span> <span class="nx">candidates</span><span class="p">[</span><span class="nx">max</span><span class="p">]</span> <span class="err">:</span> <span class="nx">word</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">BEGIN</span><span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nb">ARGC</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="nb">ARGV</span><span class="p">[</span><span class="nb">ARGC</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;big.txt&quot;</span> <span class="c1"># http://norvig.com/big.txt</span>
</span><span class='line'>       <span class="k">while</span><span class="p">(</span><span class="o">++</span><span class="nx">i</span><span class="o">&lt;=</span><span class="kr">length</span><span class="p">(</span><span class="nx">x</span><span class="o">=</span><span class="s2">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><span class="p">))</span> <span class="nx">alpha</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="kr">substr</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>       <span class="nb">IGNORECASE</span><span class="o">=</span><span class="nb">RS</span><span class="o">=</span><span class="s2">&quot;[^&quot;</span><span class="nx">x</span><span class="s2">&quot;]+&quot;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">{</span>      <span class="o">++</span><span class="nx">NWORDS</span><span class="p">[</span><span class="kr">tolower</span><span class="p">(</span><span class="o">$</span><span class="mi">1</span><span class="p">)]</span>   <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">END</span><span class="p">{</span>   <span class="kr">print</span> <span class="p">(</span><span class="nx">word</span> <span class="o">in</span> <span class="nx">NWORDS</span><span class="p">)</span> <span class="err">?</span> <span class="nx">word</span> <span class="err">:</span> <span class="s2">&quot;correct(&quot;</span><span class="nx">word</span><span class="s2">&quot;)=&gt; &quot;</span> <span class="nx">correct</span><span class="p">(</span><span class="kr">tolower</span><span class="p">(</span><span class="nx">word</span><span class="p">))</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>
This is my version of the Norvig&#8217;s Spell Corrector in gnu awk.</p>

<p>Follow the code we can find 2 functions and 3 blocks of code. Awk is a oriented to data flow, I&#8217;m always reading something, in this case I read a huge file <a href="http://norvig.com/big.txt">big.txt</a> with many words. It is a good sample of word frequency distributions, the most common words should be present in more number than rare words.</p>

<!-- more -->


<p>I can read and store the frequency of the word using this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='awk'><span class='line'><span class="p">{</span>  <span class="o">++</span><span class="nx">NWORDS</span><span class="p">[</span><span class="kr">tolower</span><span class="p">(</span><span class="o">$</span><span class="mi">1</span><span class="p">)]</span>   <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>
it is a map between the word (in lowercase) and how many times I can find in the text.</p>

<p>But, how I can read one word per time? In awk, $1 is the first field in one register. When I read one text, awk consider each line as a register and each work as a field and I can change this with the Record Separator (RS, new line by default) and Field Separator (FS, one or more space/tabs by default) variables.</p>

<p>I&#8217;m using the BEGIN block to setup the script:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='awk'><span class='line'><span class="nx">BEGIN</span><span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nb">ARGC</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="nb">ARGV</span><span class="p">[</span><span class="nb">ARGC</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;big.txt&quot;</span> <span class="c1"># http://norvig.com/big.txt</span>
</span><span class='line'>      <span class="k">while</span><span class="p">(</span><span class="o">++</span><span class="nx">i</span><span class="o">&lt;=</span><span class="kr">length</span><span class="p">(</span><span class="nx">x</span><span class="o">=</span><span class="s2">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><span class="p">))</span> <span class="nx">alpha</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="kr">substr</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="nb">IGNORECASE</span><span class="o">=</span><span class="nb">RS</span><span class="o">=</span><span class="s2">&quot;[^&quot;</span><span class="nx">x</span><span class="s2">&quot;]+&quot;</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>First, if there is no arguments, I add the <a href="http://norvig.com/big.txt">big.txt</a> to read and store in &#8216;NWORDS&#8217;.</p>

<p>Second, I create an array &#8216;alpha&#8217; with each letter. I&#8217;m using the temporary variable x to store the valid sequence of words and change the value of RS to a regular expression who match one (or more) non alpha chars. In awk, string concatenation is very simple:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='awk'><span class='line'><span class="nb">RS</span> <span class="o">=</span> <span class="s2">&quot;[^&quot;</span> <span class="nx">x</span> <span class="s2">&quot;]+&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>   <br/>
is equivalent to</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='awk'><span class='line'><span class="nb">RS</span> <span class="o">=</span> <span class="s2">&quot;[^abcdefghijklmnopqrstuvwxyz]+&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>
The variable IGNORECASE, with a non 0 value, change the behavior of regular expressions.</p>

<p>After setup the script and read big.txt (or other file(s)) and create NWORDS map, we execute the END block:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='awk'><span class='line'><span class="nx">END</span><span class="p">{</span>   <span class="kr">print</span> <span class="p">(</span><span class="nx">word</span> <span class="o">in</span> <span class="nx">NWORDS</span><span class="p">)</span> <span class="err">?</span> <span class="nx">word</span> <span class="err">:</span> <span class="s2">&quot;correct(&quot;</span><span class="nx">word</span><span class="s2">&quot;)=&gt; &quot;</span> <span class="nx">correct</span><span class="p">(</span><span class="kr">tolower</span><span class="p">(</span><span class="nx">word</span><span class="p">))</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>   <br/>
What is &#8216;word&#8217;? To run this script we pass this variable directly to the script using -v option.</p>

<pre><code>gawk -v word=some_word_to_verify -f spelling.awk    
</code></pre>

<p>If this word has no problems I can find in NWORDS, but if i can&#8217;t find, I call the &#8216;correct&#8217; function.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='awk'><span class='line'><span class="kd">function</span> <span class="nx">correct</span><span class="p">(</span><span class="nx">word</span>            <span class="p">,</span><span class="nx">candidates</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">list</span><span class="p">,</span><span class="nx">max</span><span class="p">,</span><span class="nx">temp</span><span class="p">){</span>
</span><span class='line'>   <span class="nx">edits</span><span class="p">(</span><span class="nx">word</span><span class="p">,</span><span class="kr">length</span><span class="p">(</span><span class="nx">word</span><span class="p">),</span><span class="nx">candidates</span><span class="p">,</span><span class="nx">list</span><span class="p">)</span>
</span><span class='line'>   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">asort</span><span class="p">(</span><span class="nx">candidates</span><span class="p">,</span><span class="nx">temp</span><span class="p">))</span> <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">in</span> <span class="nx">list</span><span class="p">)</span> <span class="nx">edits</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="kr">length</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span><span class="nx">candidates</span><span class="p">)</span>
</span><span class='line'>   <span class="k">return</span> <span class="p">(</span><span class="nx">max</span> <span class="o">=</span> <span class="nx">asorti</span><span class="p">(</span><span class="nx">candidates</span><span class="p">))</span> <span class="err">?</span> <span class="nx">candidates</span><span class="p">[</span><span class="nx">max</span><span class="p">]</span> <span class="err">:</span> <span class="nx">word</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>
All variables in awk are globals. To create local variables we add in the function signature. It is ugly but it is the only way, and the convention is separate the local variables with many spaces (in this case: candidates, i, list, max and temp).</p>

<p>The function correct call edits and return a unique list with possible correct words OR I call edits again with each &#8216;candidate&#8217;. The asort is a portable way to return the size of the array/map and I do not change the original (i use temp). asorti order a map by the value of his indexes to find the maximum value. In this case, max is the size of the array and the last element is the most common word in the map (candidates[max]).</p>

<p>and here is the magic of edits:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='awk'><span class='line'><span class="kd">function</span> <span class="nx">edits</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">max</span><span class="p">,</span><span class="nx">candidates</span><span class="p">,</span><span class="nx">list</span><span class="p">,</span>        <span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">){</span>
</span><span class='line'>   <span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span>  <span class="nx">max</span> <span class="p">;</span><span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="o">++</span><span class="nx">list</span><span class="p">[</span><span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># deletes</span>
</span><span class='line'>   <span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span> <span class="nx">max</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="o">++</span><span class="nx">list</span><span class="p">[</span><span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">3</span><span class="p">)]</span> <span class="c1"># transposes</span>
</span><span class='line'>   <span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span>  <span class="nx">max</span> <span class="p">;</span><span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="k">for</span><span class="p">(</span><span class="nx">j</span> <span class="o">in</span> <span class="nx">alpha</span><span class="p">)</span> <span class="o">++</span><span class="nx">list</span><span class="p">[</span><span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="nx">alpha</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># replaces</span>
</span><span class='line'>   <span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;=</span> <span class="nx">max</span> <span class="p">;</span><span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="k">for</span><span class="p">(</span><span class="nx">j</span> <span class="o">in</span> <span class="nx">alpha</span><span class="p">)</span> <span class="o">++</span><span class="nx">list</span><span class="p">[</span><span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span> <span class="nx">alpha</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="kr">substr</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="c1"># inserts</span>
</span><span class='line'>   <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">in</span> <span class="nx">list</span><span class="p">)</span> <span class="k">if</span><span class="p">(</span><span class="nx">i</span> <span class="o">in</span> <span class="nx">NWORDS</span><span class="p">)</span> <span class="nx">candidates</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">NWORDS</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>
I&#8217;m using w as a mnemonic of word to reduce the size of each statement, specialty in &#8216;transposes&#8217;. Here we get the word and try to apply 4 types of operations: deletes, transposes, replaces and inserts (see the <a href="http://norvig.com/spell-correct.html">original article</a> ). If we find, we add copy the value from NWORDS to candidates.</p>

<p>The idea is simple: if I apply all four operations and find one or more candidates in NWORDS, the most probably word will be the most present word in big.txt - QED.</p>

<p>Example:</p>

<pre><code>$ wget http://norvig.com/big.txt
$ time gawk -v word=reciet -f spelling.awk 
correct(reciet)=&gt; recite

real 0m4.450s
user 0m4.351s
sys 0m0.027s
</code></pre>

<p>Thanks for your time.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Tiago Peczenyj</span></span>

      








  


<time datetime="2012-12-29T03:17:00-02:00" pubdate data-updated="true">Dec 29<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/algorithm/'>Algorithm</a>, <a class='category' href='/blog/categories/awk/'>Awk</a>, <a class='category' href='/blog/categories/open-source/'>Open Source</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://pacman.blog.br/blog/2012/12/29/spell-correct-in-gawk/" data-via="pac_man" data-counturl="http://pacman.blog.br/blog/2012/12/29/spell-correct-in-gawk/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/12/29/hello/" title="Previous Post: hello">&laquo; hello</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/01/10/codility-equi-task-solution-in-modern-perl/" title="Next Post: Codility Equi Task Solution in Modern Perl">Codility Equi Task Solution in Modern Perl &raquo;</a>
      
    </p>
  </footer>
</article>

<section>
<script type="text/javascript"><!--
      google_ad_client = "ca-pub-0605393685377350";
      /* blog1 */
      google_ad_slot = "7472658989";
      google_ad_width = 468;
      google_ad_height = 15;
      //-->
      </script>
      <script type="text/javascript"
      src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script>
</section>


  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    
<section>
	<span>
		<img src="http://www.gravatar.com/avatar/bb21b27fe43fac2f302cdf3bfc59a6e9" alt="Gravatar of Tiago Peczenyj " title="Gravatar of Tiago Peczenyj" />
	</span>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/02/07/moosex-a-new-ruby-dsl-for-object-oriented-programming-and-much-more/">MooseX - a new Ruby DSL for Object Oriented Programming (and much more)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/07/adding-a-dry-run-capability-to-your-moose-class-with-moosex-role-dryrunnable/">Adding a 'dry run' capability to your Moose class with MooseX::Role::DryRunnable</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/23/lazy-bool-my-first-module-in-cpan/">Lazy::Bool my first module in CPAN</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/22/schwartzian-transform/">Schwartzian transform</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/10/codility-equi-task-solution-in-modern-perl/">Codility Equi Task Solution in Modern Perl</a>
      </li>
    
  </ul>
</section>

<section>
<script type="text/javascript"><!--
      google_ad_client = "ca-pub-0605393685377350";
      /* blog3 */
      google_ad_slot = "5437522583";
      google_ad_width = 200;
      google_ad_height = 200;
      //-->
      </script>
      <script type="text/javascript"
      src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script>
</section>

<section>
  <h1>Stack Overflow</h1>
  <a href="http://stackoverflow.com/users/1148194/tiago-peczenyj">
  <img src="http://stackoverflow.com/users/flair/1148194.png" width="208" height="58" alt="profile for tiago-peczenyj at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for tiago-peczenyj at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
  </a>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/peczenyj">@peczenyj</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'peczenyj',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("pac_man", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/pac_man" class="twitter-follow-button" data-show-count="true">Follow @pac_man</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/tiago.peczenyj?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>


<section>
  <h1>Tag Cloud</h1>
    <span id="tag-cloud"><a href='/blog/categories/algorithm' style='font-size: 101.66666666666667%'>Algorithm(1)</a> <a href='/blog/categories/amor' style='font-size: 101.66666666666667%'>Amor(1)</a> <a href='/blog/categories/aop' style='font-size: 103.33333333333333%'>AOP(2)</a> <a href='/blog/categories/awk' style='font-size: 103.33333333333333%'>awk(2)</a> <a href='/blog/categories/awk' style='font-size: 101.66666666666667%'>Awk(1)</a> <a href='/blog/categories/bope' style='font-size: 101.66666666666667%'>Bope(1)</a> <a href='/blog/categories/brasil' style='font-size: 103.33333333333333%'>Brasil(2)</a> <a href='/blog/categories/c' style='font-size: 116.66666666666667%'>C(10)</a> <a href='/blog/categories/ceticismo' style='font-size: 103.33333333333333%'>Ceticismo(2)</a> <a href='/blog/categories/chrome' style='font-size: 101.66666666666667%'>Chrome(1)</a> <a href='/blog/categories/cygwin' style='font-size: 101.66666666666667%'>Cygwin(1)</a> <a href='/blog/categories/erlang' style='font-size: 103.33333333333333%'>Erlang(2)</a> <a href='/blog/categories/filhos' style='font-size: 101.66666666666667%'>Filhos(1)</a> <a href='/blog/categories/fisl' style='font-size: 105.0%'>FISL(3)</a> <a href='/blog/categories/flisol' style='font-size: 101.66666666666667%'>flisol(1)</a> <a href='/blog/categories/fortran' style='font-size: 101.66666666666667%'>Fortran(1)</a> <a href='/blog/categories/funny' style='font-size: 101.66666666666667%'>Funny(1)</a> <a href='/blog/categories/futebol' style='font-size: 101.66666666666667%'>futebol(1)</a> <a href='/blog/categories/gabeira43' style='font-size: 101.66666666666667%'>Gabeira43(1)</a> <a href='/blog/categories/globo-com' style='font-size: 106.66666666666667%'>globo.com(4)</a> <a href='/blog/categories/help' style='font-size: 101.66666666666667%'>Help(1)</a> <a href='/blog/categories/hqs' style='font-size: 101.66666666666667%'>HQs(1)</a> <a href='/blog/categories/java' style='font-size: 118.33333333333333%'>Java(11)</a> <a href='/blog/categories/javascript' style='font-size: 103.33333333333333%'>Javascript(2)</a> <a href='/blog/categories/jericho' style='font-size: 101.66666666666667%'>jericho(1)</a> <a href='/blog/categories/jobs' style='font-size: 101.66666666666667%'>Jobs(1)</a> <a href='/blog/categories/linux' style='font-size: 130.0%'>Linux(18)</a> <a href='/blog/categories/messias' style='font-size: 101.66666666666667%'>Messias(1)</a> <a href='/blog/categories/mono' style='font-size: 101.66666666666667%'>Mono(1)</a> <a href='/blog/categories/moose' style='font-size: 101.66666666666667%'>Moose(1)</a> <a href='/blog/categories/moosex' style='font-size: 101.66666666666667%'>MooseX(1)</a> <a href='/blog/categories/nerd' style='font-size: 126.66666666666667%'>Nerd(16)</a> <a href='/blog/categories/off-topic' style='font-size: 140.0%'>off-topic(24)</a> <a href='/blog/categories/open-source' style='font-size: 101.66666666666667%'>Open Source(1)</a> <a href='/blog/categories/perl' style='font-size: 106.66666666666667%'>Perl(4)</a> <a href='/blog/categories/politica' style='font-size: 103.33333333333333%'>Politica(2)</a> <a href='/blog/categories/portoalegre' style='font-size: 101.66666666666667%'>PortoAlegre(1)</a> <a href='/blog/categories/programacao' style='font-size: 105.0%'>Programacao(3)</a> <a href='/blog/categories/punk' style='font-size: 101.66666666666667%'>Punk(1)</a> <a href='/blog/categories/rj' style='font-size: 103.33333333333333%'>Rj(2)</a> <a href='/blog/categories/ruby' style='font-size: 113.33333333333333%'>Ruby(8)</a> <a href='/blog/categories/ruby-' style='font-size: 101.66666666666667%'>Ruby,(1)</a> <a href='/blog/categories/se-arrependimento-matasse' style='font-size: 101.66666666666667%'>Se-Arrependimento-Matasse(1)</a> <a href='/blog/categories/security' style='font-size: 101.66666666666667%'>Security(1)</a> <a href='/blog/categories/sed' style='font-size: 101.66666666666667%'>sed(1)</a> <a href='/blog/categories/shell' style='font-size: 160.0%'>Shell(36)</a> <a href='/blog/categories/tchelinux' style='font-size: 101.66666666666667%'>Tchelinux(1)</a> <a href='/blog/categories/tdd' style='font-size: 108.33333333333333%'>TDD(5)</a> <a href='/blog/categories/testes' style='font-size: 101.66666666666667%'>Testes(1)</a> <a href='/blog/categories/twitter' style='font-size: 101.66666666666667%'>twitter(1)</a> <a href='/blog/categories/vagas' style='font-size: 101.66666666666667%'>Vagas(1)</a> <a href='/blog/categories/western' style='font-size: 101.66666666666667%'>Western(1)</a> <a href='/blog/categories/xml' style='font-size: 101.66666666666667%'>XML(1)</a> </span>
</section>
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Tiago Peczenyj -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'peczenyj';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://pacman.blog.br/blog/2012/12/29/spell-correct-in-gawk/';
        var disqus_url = 'http://pacman.blog.br/blog/2012/12/29/spell-correct-in-gawk/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
